@startuml
title Complex YAML Configuration (display)
note
---
# Real-Time E-Commerce Order Processing Configuration
application:
  name: "E-Commerce Platform"
  version: "2.0.0"
  environment: "production"

services:
  api_gateway:
    enabled: true
    replicas: 3
    port: 8080
    timeout_ms: 30000
    rate_limit:
      requests_per_second: 1000
      burst: 2000

  auth_service:
    enabled: true
    replicas: 2
    port: 8081
    jwt_config:
      algorithm: "HS256"
      expiry_hours: 24
      refresh_token_expiry_days: 7

  order_service:
    enabled: true
    replicas: 5
    port: 8082
    database:
      type: "postgresql"
      host: "postgres-primary.internal"
      port: 5432
      pool_size: 25
      connection_timeout_ms: 5000
    cache:
      type: "redis"
      host: "redis-cluster.internal"
      ttl_minutes: 60

  payment_service:
    enabled: true
    replicas: 3
    port: 8083
    payment_gateways:
      - name: "stripe"
        api_version: "v1"
        timeout_ms: 15000
        retries: 3
      - name: "paypal"
        timeout_ms: 20000
        retries: 2

  inventory_service:
    enabled: true
    replicas: 2
    port: 8084
    stock_check_interval_ms: 1000
    lock_timeout_seconds: 30

  notification_service:
    enabled: true
    replicas: 2
    port: 8085
    channels:
      - type: "email"
        provider: "sendgrid"
        batch_size: 100
        batch_timeout_ms: 5000
      - type: "sms"
        provider: "twilio"
        rate_limit: 100_per_minute
      - type: "push_notification"
        provider: "firebase"

  search_service:
    enabled: true
    replicas: 3
    port: 8086
    elasticsearch:
      cluster: "elasticsearch-prod"
      index_pattern: "products-*"
      shards: 5
      replicas: 2

data_stores:
  primary_database:
    type: "postgresql"
    host: "postgres-primary.us-east.rds.amazonaws.com"
    port: 5432
    database: "ecommerce_prod"
    max_connections: 100
    backup:
      enabled: true
      schedule: "0 2 * * *"
      retention_days: 30

  cache_layer:
    type: "redis"
    mode: "cluster"
    nodes:
      - "redis-1.internal:6379"
      - "redis-2.internal:6379"
      - "redis-3.internal:6379"
    persistence:
      aof_enabled: true
      fsync: "everysec"

  search_index:
    type: "elasticsearch"
    cluster_name: "elasticsearch-prod-v7"
    nodes: 3
    index_settings:
      number_of_shards: 5
      number_of_replicas: 2
      refresh_interval: "1s"

  timeseries_db:
    type: "prometheus"
    retention_period_days: 90
    scrape_interval_seconds: 15
    evaluation_interval_seconds: 15

monitoring:
  enabled: true
  metrics_collection:
    interval_seconds: 15
    retention_days: 90

  alerting:
    enabled: true
    alert_manager: "prometheus"
    rules:
      - name: "high_latency"
        condition: "p99_latency_ms > 500"
        severity: "warning"
      - name: "high_error_rate"
        condition: "error_rate > 0.01"
        severity: "critical"
      - name: "service_down"
        condition: "service_health == down"
        severity: "critical"

  logging:
    type: "elk_stack"
    log_level: "info"
    retention_days: 30

  tracing:
    enabled: true
    provider: "jaeger"
    sample_rate: 0.1

deployment:
  platform: "kubernetes"
  cluster: "eks-prod-us-east"
  namespace: "production"

  infrastructure:
    load_balancer: "nlb"
    auto_scaling:
      enabled: true
      min_replicas: 2
      max_replicas: 20
      target_cpu_percent: 70

  network:
    vpc_cidr: "10.0.0.0/16"
    availability_zones: 3
    nat_gateway:
      enabled: true
      per_az: true

  security:
    tls_enabled: true
      certificate_provider: "acm"
      min_version: "1.2"
    service_mesh: "istio"
    network_policies:
      enabled: true
      default_policy: "deny"

configuration_management:
  type: "consul"
  sync_interval_seconds: 30

feature_flags:
  new_checkout_flow: 
    enabled: true
    rollout_percentage: 100
  wishlist_feature:
    enabled: true
    rollout_percentage: 50
  one_click_checkout:
    enabled: false
    rollout_percentage: 0

...
end note

@enduml
